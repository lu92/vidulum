# Recurring Rules - Web Advanced - Dokumentacja Frontendowa

**Data utworzenia:** 2026-02-25
**Wersja:** 2.0 Advanced
**Przeznaczenie:** Frontend Web Application - Advanced Features
**Wymagania:** Wymaga MVP (`recurring-rules-web-mvp.md`)
**PowiÄ…zane dokumenty:**
- `recurring-rules-web-mvp.md` (podstawowa dokumentacja)
- `2026-02-25-recurring-rules-amount-changes-design.md` (backend design)
- `2026-02-25-recurring-rules-ai-suggestions-monitoring.md` (AI design)
- `../design/recurring-rules-web-mockups.html` (wizualizacje HTML)

---

## Spis treÅ›ci

1. [PrzeglÄ…d Advanced Features](#1-przeglÄ…d-advanced-features)
2. [Scheduled Amount Changes](#2-scheduled-amount-changes)
3. [Mismatch Detection & Resolution](#3-mismatch-detection--resolution)
4. [Tolerance-Based Matching](#4-tolerance-based-matching)
5. [Amount History & Audit Trail](#5-amount-history--audit-trail)
6. [AI Suggestions](#6-ai-suggestions)
7. [Dashboard & Analytics](#7-dashboard--analytics)
8. [API Reference (Advanced)](#8-api-reference-advanced)
9. [State Management (Advanced)](#9-state-management-advanced)

---

## 1. PrzeglÄ…d Advanced Features

### 1.1 FunkcjonalnoÅ›ci Advanced

| Funkcja | Opis | Unikalna? |
|---------|------|-----------|
| Scheduled Amount Changes | Zaplanowane zmiany kwot z datÄ… | âœ… TAK |
| Mismatch Resolution | Wykrywanie rÃ³Å¼nic i dialog rozwiÄ…zania | âœ… TAK |
| Tolerance Matching | Dopasowanie z tolerancjÄ… % | âœ… TAK |
| Preview z Impact | PodglÄ…d wpÅ‚ywu zmian | âœ… TAK |
| Amount History | Historia zmian kwot | âœ… TAK |
| AI Suggestions | Sugestie reguÅ‚ na podstawie historii | âœ… TAK |

### 1.2 Przewaga nad konkurencjÄ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VIDULUM vs KONKURENCJA                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  SCHEDULED AMOUNT CHANGES:                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚  Monarch Money: MoÅ¼esz edytowaÄ‡ kwotÄ™, ale NIE MA "od kiedy"               â”‚
â”‚  Vidulum: "Od stycznia 2027 czynsz bÄ™dzie 2,200 PLN" + preview              â”‚
â”‚                                                                              â”‚
â”‚  MISMATCH RESOLUTION:                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  Monarch Money: Pokazuje Å¼Ã³Å‚ty kolor - "coÅ› jest nie tak"                  â”‚
â”‚  Vidulum: Dialog z 3 opcjami + propagacja + preview wpÅ‚ywu                 â”‚
â”‚                                                                              â”‚
â”‚  TOLERANCE MATCHING:                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚  Konkurencja: Exact match lub rÄ™czne zatwierdzanie                         â”‚
â”‚  Vidulum: "PrÄ…d ~150 PLN Â±20%" â†’ auto-match 167 PLN                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Scheduled Amount Changes

### 2.1 Koncepcja

UÅ¼ytkownik moÅ¼e zaplanowaÄ‡ zmianÄ™ kwoty z wyprzedzeniem:
- "Od stycznia czynsz bÄ™dzie 2200 PLN (podwyÅ¼ka)"
- "Od wrzeÅ›nia przedszkole 900 PLN"
- "Od lipca pensja 9000 PLN (awans)"

### 2.2 User Journey: Planowanie podwyÅ¼ki czynszu

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            JOURNEY: ZAPLANOWANIE PODWYÅ»KI CZYNSZU                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  KONTEKST: User dostaÅ‚ pismo - od stycznia 2027 czynsz wzroÅ›nie            â”‚
â”‚            z 2000 PLN na 2200 PLN                                           â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  KROK 1: Otwarcie reguÅ‚y                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  User: Klika na reguÅ‚Ä™ "Czynsz" â†’ widok szczegÃ³Å‚Ã³w                         â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  KROK 2: Dodanie zaplanowanej zmiany                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  User: Klika "Zaplanuj zmianÄ™ kwoty"                                       â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Zaplanuj zmianÄ™ kwoty                                           [Ã—] â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Obecna kwota: 2 000 PLN                                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Nowa kwota *                                                         â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚   â”‚
â”‚  â”‚ â”‚ 2200.00             â”‚ PLN                                         â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ ObowiÄ…zuje od *                                                      â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚   â”‚
â”‚  â”‚ â”‚ 2027-01-01      ğŸ“… â”‚                                             â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ PowÃ³d (opcjonalnie)                                                  â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ PodwyÅ¼ka zgodnie z pismem z dnia 15.11.2026                    â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ ğŸ“Š PodglÄ…d wpÅ‚ywu:                                                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ â€¢ 12 transakcji zostanie zaktualizowanych (sty-gru 2027)           â”‚   â”‚
â”‚  â”‚ â€¢ Zmiana kwoty: 2 000 PLN â†’ 2 200 PLN (+200 PLN / +10%)           â”‚   â”‚
â”‚  â”‚ â€¢ Roczny wpÅ‚yw: +2 400 PLN                                         â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ [Anuluj]                                       [Zaplanuj zmianÄ™]   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  KROK 3: Potwierdzenie                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  System:                                                                    â”‚
â”‚  â€¢ Zapisuje scheduled change                                               â”‚
â”‚  â€¢ Aktualizuje transakcje od stycznia 2027                                 â”‚
â”‚  â€¢ Pokazuje toast: "Zaplanowano zmianÄ™ kwoty od 1 stycznia 2027"          â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  KROK 4: Widok w szczegÃ³Å‚ach reguÅ‚y                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Czynsz                                                 AKTYWNA      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Kwota: 2 000 PLN                                                    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ ğŸ“… Zaplanowane zmiany:                                              â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ Od 1 sty 2027: 2 200 PLN (+200 PLN)              [Edytuj] [Ã—] â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ PowÃ³d: PodwyÅ¼ka zgodnie z pismem z dnia 15.11.2026              â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ [+ Zaplanuj kolejnÄ… zmianÄ™]                                         â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 API: Scheduled Changes

**Dodanie scheduled change:**
```http
POST /api/v1/cash-flow/{cfId}/recurring-rules/{ruleId}/scheduled-changes
Authorization: Bearer {token}
Content-Type: application/json

{
  "newAmount": {
    "amount": 2200.00,
    "currency": "PLN"
  },
  "effectiveFrom": "2027-01-01",
  "reason": "PodwyÅ¼ka zgodnie z pismem z dnia 15.11.2026"
}
```

**Response:**
```json
{
  "changeId": "SC10000001",
  "ruleId": "RR10000001",
  "previousAmount": {"amount": 2000.00, "currency": "PLN"},
  "newAmount": {"amount": 2200.00, "currency": "PLN"},
  "effectiveFrom": "2027-01-01",
  "reason": "PodwyÅ¼ka zgodnie z pismem z dnia 15.11.2026",
  "affectedTransactions": 12,
  "status": "SCHEDULED",
  "createdAt": "2026-02-25T15:00:00Z"
}
```

**Lista scheduled changes:**
```http
GET /api/v1/cash-flow/{cfId}/recurring-rules/{ruleId}/scheduled-changes
```

**UsuniÄ™cie scheduled change:**
```http
DELETE /api/v1/cash-flow/{cfId}/recurring-rules/{ruleId}/scheduled-changes/{changeId}
```

---

## 3. Mismatch Detection & Resolution

### 3.1 Koncepcja

System wykrywa gdy rzeczywista transakcja rÃ³Å¼ni siÄ™ od oczekiwanej:
- Netflix 49 PLN â†’ Bank pokazuje 59 PLN (podwyÅ¼ka bez powiadomienia)
- Czynsz 2000 PLN â†’ Bank pokazuje 2050 PLN (opÅ‚aty dodatkowe)

### 3.2 User Journey: RozwiÄ…zanie mismatch

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            JOURNEY: WYKRYCIE I ROZWIÄ„ZANIE MISMATCH                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  KONTEKST: Netflix podniÃ³sÅ‚ cenÄ™ z 49 na 59 PLN bez powiadomienia          â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  KROK 1: Import transakcji z banku                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  System: Importuje transakcjÄ™ "NETFLIX" -59 PLN                            â”‚
â”‚  System: Wykrywa Å¼e oczekiwano -49 PLN                                     â”‚
â”‚  System: Tworzy MISMATCH alert                                             â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  KROK 2: Powiadomienie uÅ¼ytkownika                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”” Wykryto rÃ³Å¼nicÄ™ w transakcji                                     â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Transakcja "Netflix" z 15 marca 2026:                               â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Oczekiwano:  49 PLN                                                 â”‚   â”‚
â”‚  â”‚ Otrzymano:   59 PLN                                                 â”‚   â”‚
â”‚  â”‚ RÃ³Å¼nica:    +10 PLN (+20.4%)                                        â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚                                              [RozwiÄ…Å¼ teraz]        â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                              â”‚
â”‚  KROK 3: Dialog rozwiÄ…zania                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  User: Klika "RozwiÄ…Å¼ teraz"                                               â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ RozwiÄ…Å¼ rÃ³Å¼nicÄ™ w transakcji                                    [Ã—] â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Transakcja: Netflix Â· 15 mar 2026                                   â”‚   â”‚
â”‚  â”‚ Oczekiwano: 49 PLN â†’ Otrzymano: 59 PLN (+10 PLN)                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Jak chcesz rozwiÄ…zaÄ‡ tÄ™ rÃ³Å¼nicÄ™?                                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ â—‰ Zaktualizuj reguÅ‚Ä™ na 59 PLN                     [ZALECANE]  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚                                                                  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚   Ta i wszystkie przyszÅ‚e transakcje bÄ™dÄ… po 59 PLN            â”‚ â”‚   â”‚
â”‚  â”‚ â”‚   11 transakcji zostanie zaktualizowanych                       â”‚ â”‚   â”‚
â”‚  â”‚ â”‚   Roczny wpÅ‚yw: +120 PLN                                        â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ â—‹ Zaakceptuj tylko tÄ™ transakcjÄ™                                â”‚ â”‚   â”‚
â”‚  â”‚ â”‚                                                                  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚   ReguÅ‚a pozostanie 49 PLN                                      â”‚ â”‚   â”‚
â”‚  â”‚ â”‚   UÅ¼yj gdy to jednorazowa rÃ³Å¼nica (np. promocja, bÅ‚Ä…d)         â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ â—‹ Zaplanuj zmianÄ™ od tej daty                                   â”‚ â”‚   â”‚
â”‚  â”‚ â”‚                                                                  â”‚ â”‚   â”‚
â”‚  â”‚ â”‚   Od 15 mar 2026: 59 PLN                                        â”‚ â”‚   â”‚
â”‚  â”‚ â”‚   Poprzednie transakcje pozostanÄ… po 49 PLN                    â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ [Anuluj]                                             [Zastosuj]    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 API: Mismatch Resolution

**Lista mismatchÃ³w:**
```http
GET /api/v1/cash-flow/{cfId}/recurring-rules/mismatches
```

**Response:**
```json
{
  "mismatches": [
    {
      "mismatchId": "MM10000001",
      "ruleId": "RR10000002",
      "ruleName": "Netflix",
      "transactionId": "CC10000123",
      "transactionDate": "2026-03-15",
      "expectedAmount": {"amount": 49.00, "currency": "PLN"},
      "actualAmount": {"amount": 59.00, "currency": "PLN"},
      "difference": {"amount": 10.00, "currency": "PLN"},
      "differencePercent": 20.4,
      "status": "PENDING",
      "detectedAt": "2026-03-15T12:00:00Z"
    }
  ],
  "totalPending": 1
}
```

**RozwiÄ…zanie mismatch:**
```http
POST /api/v1/cash-flow/{cfId}/recurring-rules/mismatches/{mismatchId}/resolve
Authorization: Bearer {token}
Content-Type: application/json

{
  "resolution": "UPDATE_RULE",  // UPDATE_RULE | ACCEPT_ONCE | SCHEDULE_CHANGE
  "effectiveFrom": "2026-03-15"  // tylko dla SCHEDULE_CHANGE
}
```

---

## 4. Tolerance-Based Matching

### 4.1 Koncepcja

Dla transakcji o zmiennej kwocie (rachunki za prÄ…d, gaz) user moÅ¼e ustawiÄ‡ tolerancjÄ™:
- "PrÄ…d ~150 PLN Â±20%" â†’ auto-match 120-180 PLN
- "Gaz ~200 PLN Â±50 PLN" â†’ auto-match 150-250 PLN

### 4.2 UI: Ustawienie tolerancji

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Opcje zaawansowane                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ â˜‘ Kwota jest szacunkowa                                                    â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€ Tolerancja dopasowania â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚                                                                       â”‚   â”‚
â”‚ â”‚ Typ tolerancji:                                                       â”‚   â”‚
â”‚ â”‚ â—‰ Procentowa    â—‹ Kwotowa                                            â”‚   â”‚
â”‚ â”‚                                                                       â”‚   â”‚
â”‚ â”‚ Tolerancja: â”Œâ”€â”€â”€â”€â”€â” %                                                â”‚   â”‚
â”‚ â”‚             â”‚ 20  â”‚                                                   â”‚   â”‚
â”‚ â”‚             â””â”€â”€â”€â”€â”€â”˜                                                   â”‚   â”‚
â”‚ â”‚                                                                       â”‚   â”‚
â”‚ â”‚ Dla kwoty 150 PLN:                                                   â”‚   â”‚
â”‚ â”‚ â€¢ Minimum: 120 PLN (-20%)                                            â”‚   â”‚
â”‚ â”‚ â€¢ Maximum: 180 PLN (+20%)                                            â”‚   â”‚
â”‚ â”‚                                                                       â”‚   â”‚
â”‚ â”‚ Transakcje w tym zakresie zostanÄ… automatycznie dopasowane.         â”‚   â”‚
â”‚ â”‚                                                                       â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 API: Tolerance Settings

**W request tworzenia/edycji reguÅ‚y:**
```json
{
  "name": "PrÄ…d",
  "amount": {"amount": 150.00, "currency": "PLN"},
  "amountIsEstimate": true,
  "tolerance": {
    "type": "PERCENTAGE",  // PERCENTAGE | ABSOLUTE
    "value": 20.0          // 20% lub 50 PLN
  }
}
```

---

## 5. Amount History & Audit Trail

### 5.1 Koncepcja

PeÅ‚na historia zmian kwot dla kaÅ¼dej reguÅ‚y:
- Kto zmieniÅ‚, kiedy, z jakiej na jakÄ… kwotÄ™
- PowÃ³d zmiany
- Export dla audytorÃ³w

### 5.2 UI: Historia zmian

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Historia zmian kwoty Â· Czynsz                                           [Ã—] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ“… 1 sty 2027 Â· Zaplanowana zmiana                                    â”‚   â”‚
â”‚ â”‚ 2 000 PLN â†’ 2 200 PLN (+200 PLN / +10%)                              â”‚   â”‚
â”‚ â”‚ PowÃ³d: PodwyÅ¼ka zgodnie z pismem z dnia 15.11.2026                   â”‚   â”‚
â”‚ â”‚ ZmieniÅ‚: jan.kowalski@email.com                                       â”‚   â”‚
â”‚ â”‚ Zmieniono: 25 lut 2026, 15:30                                         â”‚   â”‚
â”‚ â”‚ Status: â³ Zaplanowana                                                â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ“… 1 mar 2026 Â· Utworzenie reguÅ‚y                                     â”‚   â”‚
â”‚ â”‚ Kwota poczÄ…tkowa: 2 000 PLN                                          â”‚   â”‚
â”‚ â”‚ ZmieniÅ‚: jan.kowalski@email.com                                       â”‚   â”‚
â”‚ â”‚ Zmieniono: 25 lut 2026, 14:30                                         â”‚   â”‚
â”‚ â”‚ Status: âœ“ Aktywna                                                     â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                              â”‚
â”‚ [Eksportuj historiÄ™ (CSV)]                                    [Zamknij]    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 API: Amount History

```http
GET /api/v1/cash-flow/{cfId}/recurring-rules/{ruleId}/amount-history
```

**Response:**
```json
{
  "ruleId": "RR10000001",
  "ruleName": "Czynsz",
  "history": [
    {
      "changeId": "AH10000002",
      "previousAmount": {"amount": 2000.00, "currency": "PLN"},
      "newAmount": {"amount": 2200.00, "currency": "PLN"},
      "effectiveFrom": "2027-01-01",
      "changeType": "SCHEDULED_CHANGE",
      "reason": "PodwyÅ¼ka zgodnie z pismem z dnia 15.11.2026",
      "changedBy": "jan.kowalski@email.com",
      "changedAt": "2026-02-25T15:30:00Z",
      "status": "SCHEDULED"
    },
    {
      "changeId": "AH10000001",
      "previousAmount": null,
      "newAmount": {"amount": 2000.00, "currency": "PLN"},
      "effectiveFrom": "2026-03-01",
      "changeType": "RULE_CREATED",
      "reason": null,
      "changedBy": "jan.kowalski@email.com",
      "changedAt": "2026-02-25T14:30:00Z",
      "status": "ACTIVE"
    }
  ]
}
```

---

## 6. AI Suggestions

### 6.1 Koncepcja

System analizuje historiÄ™ transakcji i sugeruje reguÅ‚y:
- "WykryliÅ›my Netflix co miesiÄ…c ~49 PLN. UtworzyÄ‡ reguÅ‚Ä™?"
- "ZauwaÅ¼yliÅ›my regularne przelewy na konto X co 2 tygodnie"

### 6.2 UI: Panel sugestii

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡ Sugerowane reguÅ‚y                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ Na podstawie Twojej historii transakcji wykryliÅ›my potencjalne reguÅ‚y:     â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ“º NETFLIX                                              [UtwÃ³rz] [Ã—] â”‚   â”‚
â”‚ â”‚                                                                       â”‚   â”‚
â”‚ â”‚ Wykryto: 6 transakcji, ~49 PLN, 15. kaÅ¼dego miesiÄ…ca               â”‚   â”‚
â”‚ â”‚ Kategoria sugerowana: Rozrywka                                       â”‚   â”‚
â”‚ â”‚ PewnoÅ›Ä‡: 95%                                                          â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ‹ï¸ BENEFIT SYSTEMS                                      [UtwÃ³rz] [Ã—] â”‚   â”‚
â”‚ â”‚                                                                       â”‚   â”‚
â”‚ â”‚ Wykryto: 4 transakcji, ~150 PLN, 1. kaÅ¼dego miesiÄ…ca               â”‚   â”‚
â”‚ â”‚ Kategoria sugerowana: Sport                                          â”‚   â”‚
â”‚ â”‚ PewnoÅ›Ä‡: 85%                                                          â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ’³ ALLEGRO PAY                                          [UtwÃ³rz] [Ã—] â”‚   â”‚
â”‚ â”‚                                                                       â”‚   â”‚
â”‚ â”‚ Wykryto: 3 transakcji, ~89 PLN, 10. kaÅ¼dego miesiÄ…ca               â”‚   â”‚
â”‚ â”‚ Kategoria sugerowana: Zakupy                                         â”‚   â”‚
â”‚ â”‚ PewnoÅ›Ä‡: 70%                                                          â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ [OdrzuÄ‡ wszystkie]                     [Skanuj ponownie] [Nie pokazuj wiÄ™cej]â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 API: AI Suggestions

**Pobierz sugestie:**
```http
GET /api/v1/cash-flow/{cfId}/recurring-rules/suggestions
```

**Response:**
```json
{
  "suggestions": [
    {
      "suggestionId": "SG10000001",
      "suggestedRule": {
        "name": "NETFLIX",
        "amount": {"amount": 49.00, "currency": "PLN"},
        "type": "OUTFLOW",
        "categoryName": "Rozrywka",
        "pattern": {"type": "MONTHLY", "dayOfMonth": 15},
        "counterpartyName": "NETFLIX"
      },
      "confidence": 0.95,
      "matchedTransactions": 6,
      "firstOccurrence": "2025-10-15",
      "lastOccurrence": "2026-03-15"
    }
  ],
  "totalSuggestions": 3
}
```

**Akceptacja sugestii:**
```http
POST /api/v1/cash-flow/{cfId}/recurring-rules/suggestions/{suggestionId}/accept
```

**Odrzucenie sugestii:**
```http
POST /api/v1/cash-flow/{cfId}/recurring-rules/suggestions/{suggestionId}/dismiss
```

---

## 7. Dashboard & Analytics

### 7.1 Widok Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ReguÅ‚y cykliczne Â· Dashboard                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€ Podsumowanie â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  ğŸ“Š Aktywne reguÅ‚y: 8        â¸ Wstrzymane: 2        âœ“ ZakoÅ„czone: 3  â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  ğŸ’¸ MiesiÄ™czne wydatki:  4 250 PLN   (5 reguÅ‚)                         â”‚  â”‚
â”‚ â”‚  ğŸ’° MiesiÄ™czne przychody: 8 500 PLN   (1 reguÅ‚a)                       â”‚  â”‚
â”‚ â”‚  ğŸ“ˆ Bilans netto:        +4 250 PLN                                    â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€ NadchodzÄ…ce transakcje (7 dni) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  ğŸ“… DziÅ› (25 lut)                                                      â”‚  â”‚
â”‚ â”‚     â””â”€ (brak)                                                          â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  ğŸ“… Jutro (26 lut)                                                     â”‚  â”‚
â”‚ â”‚     â””â”€ (brak)                                                          â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  ğŸ“… 28 lut (piÄ…tek)                                                    â”‚  â”‚
â”‚ â”‚     â””â”€ ğŸ’° Pensja: +8 500 PLN                                          â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  ğŸ“… 1 mar (sobota)                                                     â”‚  â”‚
â”‚ â”‚     â””â”€ ğŸ‹ï¸ Benefit Systems: -150 PLN                                   â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  ğŸ“… 5 mar (Å›roda)                                                      â”‚  â”‚
â”‚ â”‚     â””â”€ ğŸ‘¶ Przedszkole: -800 PLN                                       â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€ WymagajÄ… uwagi â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â”‚  âš ï¸ 1 mismatch do rozwiÄ…zania                         [RozwiÄ…Å¼]       â”‚  â”‚
â”‚ â”‚  ğŸ’¡ 3 sugerowane reguÅ‚y                               [Zobacz]        â”‚  â”‚
â”‚ â”‚  ğŸ“… 1 zaplanowana zmiana (1 sty 2027)                 [SzczegÃ³Å‚y]     â”‚  â”‚
â”‚ â”‚                                                                         â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 API: Dashboard Data

```http
GET /api/v1/cash-flow/{cfId}/recurring-rules/dashboard
```

**Response:**
```json
{
  "summary": {
    "activeRules": 8,
    "pausedRules": 2,
    "endedRules": 3,
    "monthlyOutflow": {"amount": 4250.00, "currency": "PLN"},
    "monthlyInflow": {"amount": 8500.00, "currency": "PLN"},
    "netBalance": {"amount": 4250.00, "currency": "PLN"}
  },
  "upcoming": [
    {
      "date": "2026-02-28",
      "ruleName": "Pensja",
      "amount": {"amount": 8500.00, "currency": "PLN"},
      "type": "INFLOW"
    }
  ],
  "alerts": {
    "pendingMismatches": 1,
    "pendingSuggestions": 3,
    "scheduledChanges": 1
  }
}
```

---

## 8. API Reference (Advanced)

### 8.1 Dodatkowe endpointy

| Method | Endpoint | Opis |
|--------|----------|------|
| POST | `/{ruleId}/scheduled-changes` | Dodaj zaplanowanÄ… zmianÄ™ kwoty |
| GET | `/{ruleId}/scheduled-changes` | Lista zaplanowanych zmian |
| DELETE | `/{ruleId}/scheduled-changes/{changeId}` | UsuÅ„ zaplanowanÄ… zmianÄ™ |
| GET | `/mismatches` | Lista mismatchÃ³w |
| POST | `/mismatches/{id}/resolve` | RozwiÄ…Å¼ mismatch |
| GET | `/{ruleId}/amount-history` | Historia zmian kwot |
| GET | `/suggestions` | Sugestie AI |
| POST | `/suggestions/{id}/accept` | Akceptuj sugestiÄ™ |
| POST | `/suggestions/{id}/dismiss` | OdrzuÄ‡ sugestiÄ™ |
| GET | `/dashboard` | Dashboard data |

---

## 9. State Management (Advanced)

### 9.1 Rozszerzenie State

```typescript
interface RecurringRulesAdvancedState extends RecurringRulesState {
  // Scheduled Changes
  scheduledChanges: {
    byRuleId: Record<string, ScheduledChange[]>;
    formOpen: boolean;
    formRuleId: string | null;
    formData: ScheduledChangeFormData;
    isSubmitting: boolean;
  };

  // Mismatches
  mismatches: {
    items: Mismatch[];
    loading: boolean;
    totalPending: number;
    resolutionDialog: {
      isOpen: boolean;
      mismatchId: string | null;
      selectedResolution: ResolutionType | null;
    };
  };

  // Amount History
  amountHistory: {
    byRuleId: Record<string, AmountHistoryEntry[]>;
    modalOpen: boolean;
    modalRuleId: string | null;
    loading: boolean;
  };

  // AI Suggestions
  suggestions: {
    items: Suggestion[];
    loading: boolean;
    dismissed: string[];  // dismissed suggestion IDs
  };

  // Dashboard
  dashboard: {
    data: DashboardData | null;
    loading: boolean;
  };
}

interface ScheduledChange {
  changeId: string;
  ruleId: string;
  previousAmount: Money;
  newAmount: Money;
  effectiveFrom: string;
  reason: string | null;
  status: 'SCHEDULED' | 'APPLIED' | 'CANCELLED';
  createdAt: string;
}

interface Mismatch {
  mismatchId: string;
  ruleId: string;
  ruleName: string;
  transactionId: string;
  transactionDate: string;
  expectedAmount: Money;
  actualAmount: Money;
  difference: Money;
  differencePercent: number;
  status: 'PENDING' | 'RESOLVED' | 'IGNORED';
  detectedAt: string;
}

type ResolutionType = 'UPDATE_RULE' | 'ACCEPT_ONCE' | 'SCHEDULE_CHANGE';

interface Suggestion {
  suggestionId: string;
  suggestedRule: Partial<RecurringRule>;
  confidence: number;
  matchedTransactions: number;
  firstOccurrence: string;
  lastOccurrence: string;
}
```

### 9.2 Advanced Actions

```typescript
// Scheduled Changes
actions.fetchScheduledChanges(ruleId: string): Promise<void>
actions.openScheduledChangeForm(ruleId: string): void
actions.closeScheduledChangeForm(): void
actions.submitScheduledChange(): Promise<void>
actions.deleteScheduledChange(ruleId: string, changeId: string): Promise<void>

// Mismatches
actions.fetchMismatches(): Promise<void>
actions.openResolutionDialog(mismatchId: string): void
actions.closeResolutionDialog(): void
actions.selectResolution(resolution: ResolutionType): void
actions.resolveMismatch(): Promise<void>

// Amount History
actions.fetchAmountHistory(ruleId: string): Promise<void>
actions.openAmountHistoryModal(ruleId: string): void
actions.closeAmountHistoryModal(): void
actions.exportAmountHistory(ruleId: string): void

// AI Suggestions
actions.fetchSuggestions(): Promise<void>
actions.acceptSuggestion(suggestionId: string): Promise<void>
actions.dismissSuggestion(suggestionId: string): Promise<void>
actions.dismissAllSuggestions(): Promise<void>

// Dashboard
actions.fetchDashboard(): Promise<void>
actions.refreshDashboard(): Promise<void>
```

---

## PowiÄ…zane dokumenty

- **MVP (wymagane):** `recurring-rules-web-mvp.md`
- **Backend design:** `2026-02-25-recurring-rules-amount-changes-design.md`
- **AI design:** `2026-02-25-recurring-rules-ai-suggestions-monitoring.md`
- **Mobile version:** `recurring-rules-mobile.md`
- **HTML Mockups:** `../design/recurring-rules-web-mockups.html`
